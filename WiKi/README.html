<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>GeHoJerez</title>
<!-- 2019-06-01 sáb 14:07 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Miguel Molinos Pérez" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript" src="http://orgmode.org/mathjax/MathJax.js"></script>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        // Only one of the two following lines, depending on user settings
        // First allows browser-native MathML display, second forces HTML/CSS
        //  config: ["MMLorHTML.js"], jax: ["input/TeX"],
            jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "center",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">GeHoJerez</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. Introduction</a></li>
<li><a href="#sec-2">2. Governing Equations</a>
<ul>
<li><a href="#sec-2-1">2.1. Balance of momentum</a></li>
<li><a href="#sec-2-2">2.2. Compatibility</a></li>
<li><a href="#sec-2-3">2.3. Constitutive response</a></li>
</ul>
</li>
<li><a href="#sec-3">3. Material Point Method</a>
<ul>
<li><a href="#sec-3-1">3.1. Initial discretization</a></li>
<li><a href="#sec-3-2">3.2. Discrete Solution Procedure</a></li>
<li><a href="#sec-3-3">3.3. Explicit MPM Scheme</a></li>
<li><a href="#sec-3-4">3.4. Large strain formulation for the material-point-method</a>
<ul>
<li><a href="#sec-3-4-1">3.4.1. Tracking large deformation</a></li>
<li><a href="#sec-3-4-2">3.4.2. Large strain analysis by the material point method}</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-4">4. Proposed tests</a>
<ul>
<li><a href="#sec-4-1">4.1. Simple propagation of a shock wave in a 1D media</a></li>
<li><a href="#sec-4-2">4.2. Simple propagation of a shock wave in a 1D elastic media using the formulation &sigma; - v</a></li>
</ul>
</li>
<li><a href="#sec-5">5. Items</a>
<ul>
<li><a href="#sec-5-1">5.1. <span class="done DONE">DONE</span> Get the Nodal coordinates of the material points</a>
<ul>
<li><a href="#sec-5-1-1">5.1.1. 23-05-2019, Madrid</a></li>
</ul>
</li>
<li><a href="#sec-5-2">5.2. <span class="done DONE">DONE</span> Get the strain increment in the material points</a>
<ul>
<li><a href="#sec-5-2-1">5.2.1. 28-05-2019, Madrid</a></li>
</ul>
</li>
<li><a href="#sec-5-3">5.3. <span class="done DONE">DONE</span> Get the stress state</a></li>
</ul>
</li>
<li><a href="#sec-6">6. Codes</a></li>
<li><a href="#sec-7">7. Biblio and footnotes</a></li>
</ul>
</div>
</div>
<p>
This is a simple MPM code write in C, the main purpose of this code is to understand the basics concepts of a MPM code. I also write this lines to keep some order in my ideas during this crazy years. 
</p>

<p>
Miguel Molinos Pérez, PhD candidate <sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup>. Madrid 28-5-2019
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Introduction</h2>
<div class="outline-text-2" id="text-1">
<p>
The past several decades have brought tremendous advances in computing
power and provided fertile ground for the development of the
computational sciences. In computational solid mechanics the Finite
Element Method (FEM) (METER CITA MOLONA) has been very successfully
applied to a wide range of problems with good results. However, body
fixed FEM meshes can be difficult and time consuming to generate for
complex three-dimensional objects. Further, mesh distorsion associated
with large deformations compromises solution accuracy, ultimately
requiring re-meshing. These difficulties have spurred the development
of alternative discretization strategies which avoid mesh distorsion by
dicretizing at points and never
maintaining a body-fixed mesh.<br  />
</p>

<p>
Quite a number of ''meshless methods'' have been developed. Some of
the ways in which the methods differ include whether or not a
temporary mesh is used in the solution procedure, whether the
discretization procedure begins with the
</p>


<div id="MPM-algorithm" class="figure">
<p><img src="./WiKi/Figuras/mpm-algorithm.png" alt="mpm-algorithm.png" width="600" />
</p>
<p><span class="figure-number">Figure 1:</span> This is the workflow of the MPM-algorithm</p>
</div>
</div>
</div>


<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Governing Equations</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> Balance of momentum</h3>
<div class="outline-text-3" id="text-2-1">
<p>
In  the following  derivation  of the  discrete  equations, bold  face
quantities  indicate tensor,  \(\nabla\) id  the gradient  operator, and
\(\cdot\),  and \(:\)  are first  order (vector)  and second  order tensor
contraction, respectively. The subscript \(p\) is used to index material
point  variables   and  \(i\)   grid  vertex  variables.   The  notation
\(\sum_p^{Np}\) and \(\sum_i^{Np}\)  is used to denote  summation over all
material points, and over all grid vertex, respectively.
</p>

<p>
Of  interest  in  solid  mechanics is  the  deformation  and  material
response to a continuous solid  body under prescribed loads and initial
conditions,    as   governed    by    conservation    of   mass    and
momentum.  Conservation of  mass  is satisfied  implicitly by  leaving
discrete particle  masses unchanged throughout a  computation. Here we
develop  the  discrete  version  of conservation  of  momentum,  which
permits  evolution  of  particle  momenta   in  time.  We  consider  a
deformable body acted upon by forces and subjected to either kinematic
or  traction  boundary conditions  every  where  on its  surface.  The
continuum mechanics theory
</p>

<ul class="org-ul">
<li>Balance of momentum
</li>
<li>Compatibility
</li>
</ul>


<p>
We works over the balance of momentum in the strong formulation, as we
can see in \ref{eq:sf_conserv_momentum}
</p>

\begin{equation}
\rho a = \nabla \cdot(\sigma) + \rho b  
\end{equation}

<p>
Multiplying by \(\psi\) we get :
</p>
\begin{equation}
\psi^T \cdot \rho a = \psi^T \cdot \nabla\cdot(\sigma) + \psi^T \cdot \rho b
\end{equation}

<p>
The function \(\psi\) belongs to a space \(\mathcal{H}\) (vectorial space
with scalar product defined) wich verifies
\(a(\ddot{u},\dot{u},u,\psi)=l(\psi) \quad \forall\ \psi\ \in\
\mathcal{H}\). In other hand, in every point of \(\Omega\) where we have
imposed the Dirichlet bounday condition,
</p>


\begin{equation}
\mathcal{H} = \{  \psi(x)/\psi \mid_{\Gamma_D} = 0 \quad , \quad \psi \in H^1(\Omega)  \}
\end{equation}

<p>
In other words, \(\mathcal{H}\) is the space defined by all the
functions \(g\), that $ &psi;$ and \(\nabla \psi\) are FUNCIONES DE
CUADRADO INTEGRABLE in \(\Omega\)
</p>

\begin{equation}
\int_{\Omega}\psi\ d\Omega < \infty \quad , \quad \int_{\Omega}\nabla\psi\ d\Omega < \infty
\end{equation}

<p>
Integrating over \(\Omega\) we get :
</p>

\begin{equation}
\int_{\Omega} \psi^T \cdot \rho a\ d\Omega = \int_{\Omega} \psi^T \cdot \nabla\cdot(\sigma)\ d\Omega + \int_{\Omega} \psi^T \cdot \rho b\ d\Omega
\end{equation}

<p>
Integrating by parts the therm of the internal tension, we get :
</p>
\begin{equation}
\int_{\Omega} \psi^T\cdot \rho a\ d\Omega = \int_{\Omega}  \nabla\cdot \left( \psi^T \cdot
\sigma \right)\ d\Omega - \int_{\Omega}  \nabla\psi^T : \sigma\ d\Omega
  + \int_{\Omega} \psi^T\cdot b\ d\Omega
\end{equation}

<p>
Applying the Gauss theorem over it, and following the definition of the stress
vector \(t = \sigma \cdot n\) where \(n\) is the vector orthogonal to a
surface in the solid, finally we get the variational form for
conservation of momentum may be written as
</p>
\begin{equation}
\int_{\Omega} \psi^T \cdot \rho a\ d\Omega = \int_{\Gamma}  \psi^T
\cdot \overbrace{\sigma \cdot n}^{t}\ d\Gamma - \int_{\Omega}  \nabla \psi^T : \sigma\ d\Omega
  + \int_{\Omega} \psi^T b\ d\Omega  
\end{equation}
<p>
Finally we get :
</p>
\begin{equation}
\int_{\Omega} \psi^T \cdot \rho a\ d\Omega = \int_{\Gamma}  \psi^T
\cdot t \ d\Gamma - \int_{\Omega}  \nabla \psi^T : \sigma\ d\Omega
  + \int_{\Omega} \psi^T b\ d\Omega  
\end{equation}
</div>
</div>


<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2"><span class="section-number-3">2.2</span> Compatibility</h3>
</div>

<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3"><span class="section-number-3">2.3</span> Constitutive response</h3>
<div class="outline-text-3" id="text-2-3">
\begin{equation}
\sigma = 2G\epsilon + \lambda tr(\epsilon) I
\end{equation}
</div>
</div>
</div>


<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Material Point Method</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1"><span class="section-number-3">3.1</span> Initial discretization</h3>
<div class="outline-text-3" id="text-3-1">
<p>
The particle characteristic function are required to be a partition of
unity in the initial configuration :
</p>
\begin{equation}
  \label{eq:part_uniti_chi_i}
  \sum_{p=1}^{Np}\chi_p^i(x)\ =\ 1
\end{equation}

<p>
Where \(\chi_p^i\) denotes the particle characteristic functions
restricted to their initial positions and undeformed state. In the
simplest cases, particle characteristic function are taken to be
initially non-overlapping. However, nothing precludes overlapping, or
''fuzzy'' particles, as discussed later. Initial particle volumes
\(V_p^i\) are defined by :
</p>
\begin{equation}
  \label{eq:vpi_def}
  V_p^i = \int_{\Omega^i}\chi^i_p(x)\ d\Omega
\end{equation}
<p>
where \(\Omega^i\) is the initial volume of the continuum body to be
discredited. In addition to initial particle volumes, the material
point initial masses, \(m_p^i\), momenta, \(p_p^i\) ans stresses,
\(\sigma_p^i\), must be defined. These properties of the continuum
against the particle characteristic functions:
</p>

\begin{align}
  \label{eq:m_pi}
  m_p^i =& \int_{\Omega_i}\rho^i(x)\chi_p^i(x)\ d\Omega \\
  \label{eq:p_pi}
  p_p^i =& \int_{\Omega_i}\rho^i(x)v^i(x)\chi_p^i(x)\ d\Omega
\end{align}

<p>
where \(\rho^i_p\)
</p>
</div>
</div>

<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2"><span class="section-number-3">3.2</span> Discrete Solution Procedure</h3>
<div class="outline-text-3" id="text-3-2">
<p>
Given a material point property, \(f_p\), a representation consistent
with the initial discretization procedure is the sum over the material
points.
</p>
\begin{equation}
f(x) = \sum_p^{Np}f_p \chi_p(x)  
\end{equation}

<p>
The particle characteristic functions are used as a basis for
representing particle data throughout the computational domain and
determine the degree of smoothness of the spatial variation.
</p>

<p>
Approaching term by term of the balance of momentum using the discretization procedure of the MPM , we get the following :
</p>

<ul class="org-ul">
<li>Acceleration term :
\begin{eqnarray}
\int_{\Omega} \psi^T \rho \cdot a \cdot d\Omega =& \int_{\Omega} \psi^T \frac{m}{V}
\dot{v}\ d\Omega = \int_{\Omega} \psi^T \frac{1}{V}
\overbrace{m\dot{v}}^{\dot{p}}\ d\Omega = \int_{\Omega} \psi^T \frac{\dot{p}}{V} d\Omega = \nonumber \\
=&  \int_{\Omega} \psi^T \left[ \sum^{Np}_{p=1} \frac{\dot{p}_p}{V_p} \chi_p(x) \right]\ d\Omega =
\sum^{Np}_{p=1} \left[ \int_{\Omega_p \bigcap \Omega}
\psi^T\frac{\dot{p}_p}{V_p}\chi_p(x)\ d\Omega \right] 
\end{eqnarray}
</li>

<li>Internal forces :
\begin{align}
\int_{\Omega}  \nabla \psi^T \sigma\ d\Omega = \int_{\Omega}  \nabla
\psi^T \left[\sum^{Np}_{p=1} \sigma_p \chi_p(x) \right]\ d\Omega =
\sum^{Np}_{p=1} \left[ \int_{\Omega_p \bigcap \Omega}
\nabla\psi^T\sigma_p\chi_p(x)\ d\Omega \right]
\end{align}
</li>
<li>External forces :
</li>
</ul>
\begin{align}
\int_{\Omega} \psi^T \rho b\ d\Omega =& \int_{\Omega} \psi^T \frac{m}{V} b\
d\Omega = \int_{\Omega} \psi^T \left[ \sum^{Np}_{p=1}
\frac{m_p}{V_p}\chi_p(x) \right] b\ d\Omega = \sum_{p=1}^{Np}
\left[ \int_{\Omega_p \bigcap \Omega}
\psi^T \frac{m_p}{V_p} \chi_p(x) b\ d\Omega \right]
\end{align}  

<p>
Finally we get the balance of momentum with the GIPM :
</p>

\begin{align}
\sum^{Np}_{p=1} \left[  \int_{\Omega_p \bigcap \Omega}
\psi^T\frac{\dot{p}_p}{V_p}\chi_p(x)\ d\Omega \right] + \sum^{Np}_{p=1} \left[ \int_{\Omega_p \bigcap \Omega}
\nabla\psi^T\sigma_p\chi_p(x)\ d\Omega \right] =
\int_{\Gamma}\psi^T t\ d\Gamma + \sum_{p=1}^{Np}
\left[ \int_{\Omega_p \bigcap \Omega}
\psi^T \frac{m_p}{V_p} \chi_p(x) b\ d\Omega \right]
\end{align}

<p>
where \(\Omega_p\) denotes the current support of particle
characteristic function p, and the current particle volumes are
defined by :
</p>
\begin{equation}
V_p = \int_{\Omega_p \bigcap \Omega} \chi_p(x)\ d\Omega
\end{equation}

<p>
Rewriting the balance of momentum, the equation 
</p>

<p>
The other fundamental aspect of PIC methods is the use of a
computational grid. In MPM the grid serves as a scratch pad for the
solution of conservation of momentum, from which particle states are
updated. To complete the discretization procedure, approximations to
the admissible velocity fields, or test functions, are introduced in
terms of grid vertex quantities and grid shape functions. This step is
analogous to the development of FEM discrete equations. However, use
of both grid and particle basis functions to represent test functions
and trial functions, respectively, is a Petrov–Galerkin method,
[Johnson (1987)], and therefore more akin to some of the meshless
methods (in particular [Demkowicz and Oden (1986); Atluri and Zhu
(2000)]) than the FEM. The continuous representation, \(g(x)\), of grid
data, \(g_i\) , then
</p>
\begin{equation}
g(x) = \sum_{i = 1}^{Nn}=g_iN_i(x)
\end{equation}

<p>
Here \(N_i(x)\) is a computational grid shape function, which takes unit
value at node \(i\) and zero value all the other nodes. Further, the
shape function are required to be a partition of unity
</p>

\begin{equation}
\sum_{i=1}^{Nn} N_i(x) = 1
\end{equation}

\begin{eqnarray}  
\sum^{Np}_{p=1} \left[ \int_{\Omega_p \bigcap \Omega}
\psi^T\frac{\dot{p}_p}{V_p}\chi_p(x) d\Omega \right] =& \sum^{Np}_{p=1}\left[ \frac{1}{V_p}\int_{\Omega_p \bigcap \Omega} N_i(x) \chi_p(x) d\Omega \dot{p}_p  \right] = \nonumber \\
=& \sum_{p=1}^{Np} \overline{S}_{ip}\cdot \dot{p}_p = \dot{p}_i
\end{eqnarray}

\begin{eqnarray}
-\sum^{Np}_{p=1}\left[ \int_{\Omega_p \bigcap \Omega}\nabla\psi^T \sigma_p \chi_p  d\Omega \right] =& -\sum^{Np}_{p=1}\left[ \int_{\Omega_p \bigcap \Omega}\nabla N_i(x) \sigma_p \chi_p  d\Omega \right] = \nonumber \\
=& - \sum^{Np}_{p=1}\left[ \frac{V_p}{V_p} \int_{\Omega_p \bigcap \Omega}\nabla N_i(x) \chi_p  d\Omega \sigma_p \right] = \nonumber \\
=& - \sum^{Np}_{p=1}\left[V_p\overline{\nabla S}_{ip} \sigma_p \right] = f_i^{int}
\end{eqnarray}

\begin{equation}
\int_{\Gamma \equiv \partial \Omega} \psi^T t d\Gamma = \int_{\Gamma \equiv \partial \Omega} N_i(x) t d\Gamma = f_i^t
\end{equation}

\begin{eqnarray}
\sum_{p=1}^{Np} \left[ \int_{\Omega_p \bigcap \Omega} \psi^T \frac{m_p}{V_p} \chi_p(x) b d\Omega \right] = \sum_{p=1}^{Np} \left[ \int_{\Omega_p \bigcap \Omega} N_i(x)  \frac{m_p}{V_p} \chi_p(x) b d\Omega  \right] =  \sum_{p=1}^{Np} \overline{S}_{ip}b m_p = f_i^b  
\end{eqnarray}


\begin{eqnarray}
\sum_{p=1}^{Np} \overline{S}_{ip}\cdot \dot{p}_p  =
-\sum^{Np}_{p=1}\left[V_p\overline{\nabla S}_{ip} \sigma_p \right]
+&  \int_{\Gamma \equiv \partial \Omega} N_i(x) t d\Gamma \nonumber
+& \sum_{p=1}^{Np} \overline{S}_{ip}b m_p \nonumber\\
\Downarrow&  \\
\dot{p}_p = f_i^{int} + f_i^t + f_i^b \nonumber
\end{eqnarray}
</div>
</div>

<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3"><span class="section-number-3">3.3</span> Explicit MPM Scheme</h3>
<div class="outline-text-3" id="text-3-3">
<ol class="org-ol">
<li>Calculate the grid nodal mass and momentum by maping the particle mass and momentum to the corresponding grid nodes.
<ul class="org-ul">
<li>Get the nodal mass \(m_I^k\)
\begin{equation}
m_{I}^{k} = \sum^{n_p}_{p=1} m_p N_{Ip}^{k}
\end{equation} 
</li>
<li>Get the nodal momentum \(p_{I,i}^{k-1/2}\)
\begin{equation}
p_{I,i}^{k-1/2} = \sum^{n_p}_{p=1} m_p v_{ip}^{k-1/2}N_{Ip}^{k}
\end{equation}
</li>
</ul>
</li>
<li>Impose essential boundary conditions on the grid nodal momentum. At the fixed boundary, set \(p_{iI}^{k-1/2} = 0\).   
</li>
<li>For the USF only, calculate the particle strain increment \(\Delta \epsilon_{ijp}^{k-1/2}\), and the update the particle density and stress as follows:
<ul class="org-ul">
<li>Calculate the grid nodal velocity \(v_{iI}^{k-1/2}\)
\begin{equation}
v_{iI}^{k-1/2} = \frac{p_{iI}^{k-1/2}}{m_I^k}
\end{equation}
</li>
<li>Calculate the particle strain increment \(\Delta \epsilon_{ijp}^{k-1/2}\) with :
\begin{equation}
\Delta \epsilon_{ijp}^{k-1/2} = \frac{1}{2}(N_{Ip,j}^{k} v_{iI}^{k-1/2} + N_{Ip,i}^{k} v_{jI}^{k-1/2})
\end{equation}
</li>
<li>Update the particle density with :
\begin{equation}
\rho_p^{k+1} = \frac{\rho_p^k}{1 + \Delta\epsilon_{iip}^{k-1/2}}
\end{equation}
</li>
<li>Update the particle stress stated based on \(\Delta_{ijp}^{k-1/2}\) with an appropriate constitutive law.
</li>
<li></li>
</ul>
</li>
</ol>
</div>
</div>

<div id="outline-container-sec-3-4" class="outline-3">
<h3 id="sec-3-4"><span class="section-number-3">3.4</span> Large strain formulation for the material-point-method</h3>
<div class="outline-text-3" id="text-3-4">
</div><div id="outline-container-sec-3-4-1" class="outline-4">
<h4 id="sec-3-4-1"><span class="section-number-4">3.4.1</span> Tracking large deformation</h4>
<div class="outline-text-4" id="text-3-4-1">
<p>
The geometric area associated with a material point is the given the notion <code>voxel</code>. 
In the reference configuration, the voxel is defined such that \(V_p\) corresponds to 
the size of the <code>voxel</code>. The <code>voxel</code> notion, was introduced by
\cite{Steffen2008}. The location of the corners associated with each
voxel at a deformed state is specified through the
deformation-gradient tensor which needs to be tracked throughout the
simulation.
Adopting this concept, a deformation gradient is associated with each
material point in the current state as
</p>
\begin{equation}
F_p = \frac{\partial x_p}{\partial x^0} = \frac{1}{V_p^0}
\int_{\Omega_p^0}F(x)\ d\Omega  
\end{equation}

<p>
In the initial configuration, the deformation gradient tensor is
know. Typically, an undeformed material state will be prescribed (\(F^0
= I\), where \(I\) is the identity tensor). An explicit forward
difference updating scheme for updating the deformation gradient is
employed as we can see in
</p>

\begin{equation}
  \label{eq:update_defor_grad}
  F^{k+1} = \Delta F^{k+1} F^{k}
\end{equation}



<p>
This way of integrating the deformation gradient, using the grid
velocities, in also employed by \cite{Guilkey2003} and
\cite{love_sulsky_2006}
</p>
</div>
</div>



<div id="outline-container-sec-3-4-2" class="outline-4">
<h4 id="sec-3-4-2"><span class="section-number-4">3.4.2</span> Large strain analysis by the material point method}</h4>
<div class="outline-text-4" id="text-3-4-2">
<ul class="org-ul">
<li>Evaluationg the weighting functions using Gauss
</li>

<li>Analytical approximation of the weighting functions
</li>

<li>Refinement in the material-point-method
</li>

<li>Material-point splitting
</li>

<li>Material-point splitting in case of extreme deformations
</li>

<li>Refining the computational grid
</li>
</ul>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> Proposed tests</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1"><span class="section-number-3">4.1</span> Simple propagation of a shock wave in a 1D media</h3>
<div class="outline-text-3" id="text-4-1">
<p>
Here we solve the transport equation with a time integrator called Two-Step Taylor-Galerkin that stabilize the solution avoiding the formation of spurious oscillations during the transport. For the spatial discretization will be used 1D li
</p>

<p>
&part;<sub>t</sub> u + c &sdot; &part;<sub>x</sub> u = 0
</p>

<p>
The algorithm is as follows : 
</p>
<ol class="org-ol">
<li>Transfer information to the Gauss-Points :  u<sup>n</sup><sub>GP</sub> = &sum;<sup>N</sup><sub>i=0</sub>N(x<sub>i</sub>) &sdot; u<sup>n</sup><sub>i</sub>
</li>
<li>Get the solution in the Gauss-Points for t = n + 1/2 : u<sup>n+1/2</sup><sub>GP</sub> = u<sup>n</sup><sub>GP</sub> - &Delta; t/2 &sdot; &sum;<sup>N</sup><sub>i=0</sub> &part; N(x<sub>i</sub>) &sdot; u<sup>n</sup><sub>i</sub>
</li>
<li>Get the solution in the nodes for t = n + 1 : 
</li>
</ol>
</div>
</div>

<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2"><span class="section-number-3">4.2</span> Simple propagation of a shock wave in a 1D elastic media using the formulation &sigma; - v</h3>
</div>
</div>


<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> Items</h2>
<div class="outline-text-2" id="text-5">
</div><div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1"><span class="section-number-3">5.1</span> <span class="done DONE">DONE</span> Get the Nodal coordinates of the material points</h3>
<div class="outline-text-3" id="text-5-1">
</div><div id="outline-container-sec-5-1-1" class="outline-4">
<h4 id="sec-5-1-1"><span class="section-number-4">5.1.1</span> 23-05-2019, Madrid</h4>
</div>
</div>

<div id="outline-container-sec-5-2" class="outline-3">
<h3 id="sec-5-2"><span class="section-number-3">5.2</span> <span class="done DONE">DONE</span> Get the strain increment in the material points</h3>
<div class="outline-text-3" id="text-5-2">
</div><div id="outline-container-sec-5-2-1" class="outline-4">
<h4 id="sec-5-2-1"><span class="section-number-4">5.2.1</span> 28-05-2019, Madrid</h4>
</div>
</div>
<div id="outline-container-sec-5-3" class="outline-3">
<h3 id="sec-5-3"><span class="section-number-3">5.3</span> <span class="done DONE">DONE</span> Get the stress state</h3>
</div>
</div>


<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6"><span class="section-number-2">6</span> Codes</h2>
<div class="outline-text-2" id="text-6">
<div class="org-src-container">

<pre class="src src-C">fprintf("Hola mundo \n");
</pre>
</div>
</div>
</div>


<div id="outline-container-sec-7" class="outline-2">
<h2 id="sec-7"><span class="section-number-2">7</span> Biblio and footnotes</h2>
<div class="outline-text-2" id="text-7">
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p class="footpara">
<a href="https://www.researchgate.net/profile/Miguel_Molinos_Perez">ResearcheGate Profile</a>  
</p></div>


</div>
</div></div>
<div id="postamble" class="status">
<p class="author">Author: Miguel Molinos Pérez</p>
<p class="date">Created: 2019-06-01 sáb 14:07</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.2.2 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
