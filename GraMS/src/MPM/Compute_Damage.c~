#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <math.h>
#include "../GRAMS/grams.h"

Matrix ComputeDamage(Matrix W, Matrix Damage){
  
  /* 6ยบ Get the deformation energy */
  Damage = MPM_Mesh.Mat.ji.nV[i];
  
  /* Update GP neighbours */
  GP_Neighbours(MPM_Mesh,FEM_Mesh, 0.1);
  
  /* 7ยบ Calcule damage parameter */
  MPM_Mesh.Mat.ji = EigenerosionAlgorithm(MPM_Mesh.Mat.ji, MPM_Mesh.Mat.mass,
  					  MPM_Mesh.Phi.W, MPM_Mesh.Mat.Ceps,
  					  double G_F, MPM_Mesh.Beps);

  return Damage;

}

/*******************************************************/
